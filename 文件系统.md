## 文件系统

### 文件系统分类：

1. Ext4：RHEL6的默认文件管理系统
2. XFS：可支持18EB的存储容量，RHEL7以上的文件管理系统

### 常见的目录以及存放内容：

| 目录名称 | 放置文件的内容                             |
| -------- | ------------------------------------------ |
| /        | 最上层的根目录                             |
| /boot    | 开机所需文件——内核、开机菜单以及所配置文件 |
| /dev     | 以文件形式存放任何设备和接口               |
| /etc     | 配置文件                                   |
| /home    | 用户家目录                                 |
| /bin     | Binary,存放用户可运行程序                  |
| /lib     | 开机时用到的函数库，                       |
| /sbin    | 开机时所需要的命令                         |
| /media   | 用于挂载设备文件的目录                     |
| /opt     | 放置第三方软件                             |
| /root    | 系统管理员的家目录                         |
| /srv     | 一些网络服务的数据文件目录                 |
| /tmp     | 临时目录                                   |

### 文件和文件的权限：

1. 各组的含义：
   1. 文件类型和权限；连接数；文件拥有者；文件所在拥有组；文件大小；文件修改时间；文件名

   2. 第1组的文件类型权限：

      第1个字符区分文件的类型：

      | 类型         | 取值 |
      | ------------ | ---- |
      | 目录         | d    |
      | 文件         | -    |
      | 符号链接文件 | l    |
      | 块设备文件   | b    |
      | 字符设备文件 | c    |
      | 套接字文件   | s    |
      | 命名管道文件 | p    |

   3. 第2~10个字符表示文件的访问权限

      例子：

      d:文件类型

      rwx：user，文件拥有者的权限，可读、可写、可执行（字符2~4）

      r-x：group，文件所在拥有组的权限，可读、可执行(字符5~7)

      r-x：other，其他人的权限，可读，可执行（字符8~10）

   4. 注：

      1. ln -s 源文件  目标文件  #创建软连接
      2. ln  源文件  目标文件  #创建硬链接
      3. 软连接：相当于快捷方式
      4. 硬连接：创建副件

   5. 文件权限的修改：

      1. chmod命令修改权限：
         1. chmod	选项	文件
         2. 数字表示法：读取（r）---1、写入（w）---2、执行（x）---1，没有授权表示0，把权限相加分组表示
         3. 例子：
            1. 数字表示法：chmod 651 test.sh
            2. 文字表示法：u=user、g=group、o=other、a=all
               1. chmod u=rw，g=rx，o=x test.sh
               2. chomd a=rw test.sh
            3. 操作符号：
               1. +：添加某种权限
               2. -：取消某种权限
               3. =：赋予给定权限并取消原来权限
      2. chmod修改文件的特殊权限
         1. suid：普通用户可以使用文件拥有者执行权限（二进制文件、可执行文件）
         2. 例子格式： chmod u+s /user/bin/passwd

## 管理磁盘：

### 磁盘分类：

1. 机械硬盘
   1. 存储容量=磁头数*磁道数（柱面数） *每磁道扇区数 *每扇区的字节数
   2. 磁盘最小的存储单位：扇区
   3. 每个扇区的大小：512Bytes
   4. 操作系统文件存取的最小单位是：块；8个连续的扇区；1个块=8*0.5KB=4KB
2. 固态硬盘

### 工作原理：

1. 机械臂转动到相应的磁道
2. 主轴马达转动磁盘到相应扇区，将扇区转到磁头下方进行数据存取
3. 数据读取：当我们需要对数据进行读取的时候，马达会转动机械臂到对应的位置，然后由磁头感应对应位置的极性，比如感应到N级代表1，感应到S极代表0
4. 数据写入 ：当我们需要对数据进行写入的时候，磁头就会产生磁性，改变对应位置的极性。由此就可以完成数据的写入或改写

### 磁盘分区：

1. #### MSDOS(MBR):（分区个数容量有所限制）

   1. 起始扇区：大小为512Bytes
      1. 主要开机记录区：安装开机管理程序（446Bytes）
      2. 分区表：记录分区状态（64Bytes），每记录一个分区（16Bytes）
      3. 结束字符：2Bytes
   2. MBR分区：
      1. 主分区和扩展分区加起来不能超过4个
      2. 扩展分区只能有1个
      3. 扩展分区无法直接使用，需要继续向下划分逻辑分区
      4. 逻辑分区的数量受到操作系统的限制
      5. 使用MBR分区，操作系统的系统容量不能超过2.2T以上的容量
      6. MBR只有一个存放分区表的区块，硬盘坏了很难救援
   3. 硬盘分区：（dev/sd），用a~p代表不同的硬盘
      1. 主分区、扩展分区编号1~4

      2. 逻辑分区编号从5开始

      3. 例如：/dev/sda5
         1. dev：硬盘设备文件所在的目录
         2. hd：表示IDE设备；sd：表示SCSI设备
         3. a：硬盘的顺序号
         4. 分区的顺序号
         
      4. 硬盘管理工具：fdisk  -l  #查看硬盘信息
         
         1. 相关命令：
         
            ![image-20240402122109556](C:\Users\11612\AppData\Roaming\Typora\typora-user-images\image-20240402122109556.png)
         
      5. mkfs命令：

         1. Linux mkfs（英文全拼：make file system）命令用于在特定的分区上建立 linux 文件系统。

         2. `mkfs [-V] [-t fstype] [fs-options] filesys [blocks]`

            - device ： 预备检查的硬盘分区，例如：/dev/sda1
            - -V : 详细显示模式
            - -t : 给定档案系统的型式，Linux 的预设值为 ext2
            - -c : 在制做档案系统前，检查该partition 是否有坏轨
            - -l bad_blocks_file : 将有坏轨的block资料加到 bad_blocks_file 里面
            - block : 给定 block 的大小

         3. 实例：

            1. 在 /dev/hda5 上建一个 msdos 的档案系统，同时检查是否有坏轨存在，并且将过程详细列出来 :

               `mkfs -V -t msdos -c /dev/hda5`

            2. 将sda6分区格式化为ext3格式

               `mkfs -t ext3 /dev/sda6 `

      6. dd命令：

         1. 我们可以使用**dd**命令结合`if`和`of`命令行选项将一个硬盘复制到另一个硬盘。
            1. 例如，如果我们有一个硬盘 `/dev/sda` 并希望将其复制到 `/dev/sdb` 中的硬盘
            2. `dd if=/dev/sda of=/dev/sdb`
         2. 我们还可以使用**dd**命令来擦除数据。
            1. 以使用**dd**通过用空字符或零覆盖磁盘来完全擦除硬盘。
            2. `sudo dd if=/dev/zero bs=5m of=/dev/sda`
         3. 备份磁盘开始的512个字节大小的MBR信息到指定文件：
            1. `dd if=/dev/hda of=/root/image count=1 bs=512`
            2.  count=1指仅拷贝一个块；bs=512指块大小为512个字节。

      7. df命令：

         1. 使用`df -h`命令来查看磁盘信息， -h 选项为根据大小适当显示：

            | 内容参数     | 含义                    |
            | ------------ | ----------------------- |
            | `Filesystem` | 文件系统                |
            | `Size`       | 分区大小                |
            | `1k-blocks`  | 单位是1KB(使用`df`查看) |
            | `Used`       | 已用容量                |
            | `Avail`      | 还可用的容量            |
            | `Use%`       | 已用百分比              |
            | `Mounted on` | 挂载点                  |

      8. du命令：

         1. `du` (disk usage)，含义为显示磁盘空间的使用情况，用于查看当前目录的大小

         2. `#查看当前目录大小
            du -sh
            #返回该目录/文件的大小
            du -sh [目录/文件]`

         3. `#查看当前文件夹下的所有文件大小（包含子文件夹）
            du -h
            #查看指定文件夹下的所有文件大小（包含子文件夹）
            du -h [目录/文件]
            #返回当前文件夹的总M数
            du -sm
            #返回指定文件夹/文件总M数
            du -sm [文件夹/文件]`

         4. 常见参数：

            参数	含义
            -s		对每个Names参数只给出占用的数据块总数
            -a		递归地显示指定目录中各文件及子目录中各文件占用的数据块数
            -b		以字节为单位列出磁盘空间使用情况（系统默认以k字节为单位）
            -k		以1024字节为单位列出磁盘空间使用情况
            -c		最后再加上一个总计（系统默认设置）
            -l		计算所有的文件大小，对硬链接文件，则计算多次
            -x		跳过在不同文件系统上的目录不予统计
            -h		以K，M，G为单位，提高信息的可读性

      9. mount命令：mount  选项   设备  挂载点

         1. mount：单独运行 **mount** 命令（不带任何参数）将显示所有当前已挂载的文件系统。有关文件系统安装到的目录及其安装选项的信息也可以在输出中找到。

         2. mount -t：

            1. 我们可以通过在命令行上传递 `-t` 选项来指定希望 **mount** 命令显示的文件系统
            2. 例如：如果我们只想查看 ext4 文件系统，我们将使用以下语法:`mount -t ext4`

         3. | 选项 | 内容                                           |
            | ---- | ---------------------------------------------- |
            | -r   | 如果不想修改要挂载的文件系统，以只读的方式挂载 |
            | -w   | 以可写的方式挂载文件系统                       |
            | -a   | 挂载文件/etc/fstab中记录的设备                 |

      10. umount：

          1. umount  设备   挂载点
          2. -a 卸除/etc/mtab中记录的所有文件系统。
          3. -h 显示帮助。
          4. -n 卸除时不要将信息存入/etc/mtab文件中。

   
2. #### GPT:（分区数量更大，容量更大）